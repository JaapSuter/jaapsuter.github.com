$media-types: (
  // name, trigger-width-px, body-ppem,  body-ppgd, 

  // default, no query
      ( 0,        undefined,        16,        24),

  // narrower  
      (-1,              552,        16,        23),
      (-2,              396,        16,        22),
      
  // wider      
      ( 1,              750,        16,        25),
      ( 2,              825,        17,        25),
      ( 3,              884,        17,        26),
      ( 4,              936,        18,        27),
      ( 5,             1026,        19,        28),
      ( 6,             1092,        20,        29),
      ( 7,             1160,        20,        30),
      ( 8,             1260,        20,        31),
      ( 9,             1344,        21,        32),
      (10,             1408,        22,        33),
      (10,             1504,        22,        34)
);

@function get-media-type($name) {
  @each $media-type in $media-types {
    @if $name == nth($media-type, 1) {
      @return $media-type;
    }
  }

  @return undefined;
}


@mixin set-body-ppem-ppgd($ppem, $ppgd) {
  $body-ppem: $ppem;
  $body-ppgd: $ppgd;
  
  $body-ppcap: get_metric_for_metric(cap, $root-font-family, ppem, $body-ppem);
  $body-ppex: get_metric_for_metric(ex, $root-font-family, ppem, $body-ppem);
  $body-ptbl: get_metric_for_metric(baseline, $root-font-family, ppem, $body-ppem);
}

$name: undefined;
$trigger-width-px: undefined;
$mq-min-px: undefined;
$mq-max-px: undefined;

@mixin responsify() {
  @each $media-type in $media-types {

    $name:             nth($media-type, 1);
    $trigger-width-px: nth($media-type, 2);
    $body-ppem:        nth($media-type, 3);
    $body-ppgd:        nth($media-type, 4);

    @include set-body-ppem-ppgd($body-ppem, $body-ppgd);

    @if $name == 0 {
      $mq-min-px: nth(get-media-type(-1), 2);
      $mq-max-px: nth(get-media-type( 1), 2);
      
      @content;
            
    } @else {
    
      $trigger-width-em: $trigger-width-px / $pprem * 1em;
    
      @if $name < 0 {        
        @media screen and (max-width: $trigger-width-em) {
          $mq-min-px: undefined;
          $mq-max-px: $trigger-width-px;
          @content;
        }
      } @else if $name > 0 {
        @media screen and (min-width: $trigger-width-em) {
          $mq-min-px: $trigger-width-px;
          $mq-max-px: undefined;
          @content;
        }
      }
    }
  }
}
